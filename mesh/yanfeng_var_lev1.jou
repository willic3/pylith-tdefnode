# ----------------------------------------------------------------------
# Set units to SI.
# ----------------------------------------------------------------------
reset
undo off
set crash save off
#{Units('si')}

# ----------------------------------------------------------------------
# Generate geometry
# ----------------------------------------------------------------------
import Cubit 'yanfeng_geometry.cub'

# ----------------------------------------------------------------------
# Set meshing scheme and sizing.
# ----------------------------------------------------------------------
volume all scheme tetmesh
# surface all scheme trimesh
${dxInner=2.0*km}
${dxMid=4.0*km}
${dxOuter=60.0*km}
surface 76 78 77 75 74 size {dxOuter}
surface 136 80 size {dxMid}
surface 90 to 133 size {dxInner}
surface 182 size {dxInner}
curve 432 433 182 165 316 314 scheme bias

# ----------------------------------------------------------------------
# Create volume mesh
# ----------------------------------------------------------------------
# mesh surface all
# surface all smooth scheme condition number beta 2.0 cpu 5
# surface all smooth scheme centroid area pull free
# smooth surface all

mesh volume all

# ----------------------------------------------------------------------
# Do one round of smoothing.
# ----------------------------------------------------------------------
# Don't do smoothing for initial (level 1) mesh.
# remesh tet quality condition no greater than 3 inflate 2
# cleanup volume all
# volume all smooth scheme condition number beta 2.0 cpu 5
# set debug 91 on
# smooth volume all

# ----------------------------------------------------------------------
# Create nodesets and material blocks.
# ----------------------------------------------------------------------
playback 'yanfeng_bc.jou'

# ----------------------------------------------------------------------
# Export mesh.
# ----------------------------------------------------------------------
export mesh "yanfeng_var_lev1.exo" dimension 3 overwrite





